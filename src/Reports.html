<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scan Reports - ScanShield</title>
    <link rel="stylesheet" href="output.css">
    <style>
        /* Custom styles for this page */
        .report-card {
            transition: all 0.3s ease;
        }
        
        .report-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .empty-state {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }
        
        .platform-tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .platform-facebook {
            background-color: #1877F2;
            color: white;
        }
        
        .platform-telegram {
            background-color: #26A5E4;
            color: white;
        }
        
        .platform-whatsapp {
            background-color: #25D366;
            color: white;
        }
        
        .platform-instagram {
            background-color: #E4405F;
            color: white;
        }
        
        .platform-tiktok {
            background-color: #000000;
            color: white;
        }
        
        .platform-other {
            background-color: #6b7280;
            color: white;
        }
        
        .search-input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Navigation Bar -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <!-- Logo -->
                <div class="flex items-center space-x-2">
                    <div class="bg-blue-600 text-white p-2 rounded-lg">
                        <span class="text-xl">üõ°Ô∏è</span>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-800">ScanShield</h1>
                        <p class="text-xs text-gray-500 -mt-1">Protect Your Purchase</p>
                    </div>
                </div>
                
                <!-- Desktop Navigation -->
                <div class="hidden md:flex space-x-8">
                    <a href="Home.html" class="text-gray-700 font-medium hover:text-blue-600">Home</a>
                    <a href="ReportScam.html" class="text-gray-700 font-medium hover:text-blue-600">Report Scam</a>
                    <a href="Reports.html" class="text-blue-600 font-bold">Reports</a>
                    <a href="CheckSeller.html" class="text-gray-700 font-medium hover:text-blue-600">Check Seller</a>
                    <a href="AnalyzeChat.html" class="text-gray-700 font-medium hover:text-blue-600">Analyze Chat</a>
                    <a href="Learn.html" class="text-gray-700 font-medium hover:text-blue-600">Learn</a>
                </div>
                
                <!-- Mobile Menu Button -->
                <button id="mobile-menu-button" class="md:hidden text-gray-700">
                    <span class="text-xl">‚ò∞</span>
                </button>
            </div>
            
            <!-- Mobile Navigation -->
            <div id="mobile-menu" class="hidden md:hidden mt-4 space-y-3 pb-2">
                <a href="Home.html" class="block py-2 text-gray-700 font-medium hover:text-blue-600 rounded-lg px-2">Home</a>
                <a href="ReportScam.html" class="block py-2 text-gray-700 font-medium hover:text-blue-600 rounded-lg px-2">Report Scam</a>
                <a href="Reports.html" class="block py-2 text-blue-600 font-bold rounded-lg px-2">Reports</a>
                <a href="CheckSeller.html" class="block py-2 text-gray-700 font-medium hover:text-blue-600 rounded-lg px-2">Check Seller</a>
                <a href="AnalyzeChat.html" class="block py-2 text-gray-700 font-medium hover:text-blue-600 rounded-lg px-2">Analyze Chat</a>
                <a href="Learn.html" class="block py-2 text-gray-700 font-medium hover:text-blue-600 rounded-lg px-2">Learn</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mx-auto px-4 py-8">
        <!-- Page Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-4">Scan Reports Database</h1>
            <div class="flex justify-center items-center space-x-4">
                <div class="bg-blue-100 text-blue-800 font-semibold px-4 py-2 rounded-lg">
                    <span id="totalReports">0</span> total reports submitted
                </div>
                <a href="ReportScam.html" class="bg-red-600 text-white font-semibold px-4 py-2 rounded-lg hover:bg-red-700 transition">
                    + Report New Scam
                </a>
            </div>
        </div>

        <!-- Search and Filter Section -->
        <div class="bg-white rounded-xl shadow-md p-6 mb-8">
            <div class="flex flex-col md:flex-row gap-4">
                <!-- Search Input -->
                <div class="flex-1">
                    <div class="relative">
                        <input 
                            type="text" 
                            id="searchInput"
                            placeholder="Search by name, phone, or description..."
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-blue-600 transition"
                        >
                        <div class="absolute right-3 top-3 text-gray-400">
                            üîç
                        </div>
                    </div>
                </div>
                
                <!-- Platform Filter -->
                <div class="md:w-64">
                    <select 
                        id="platformFilter"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-blue-600 transition"
                    >
                        <option value="all">All Platforms</option>
                        <option value="facebook">Facebook</option>
                        <option value="telegram">Telegram</option>
                        <option value="whatsapp">WhatsApp</option>
                        <option value="instagram">Instagram</option>
                        <option value="tiktok">TikTok</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <!-- Sort Options -->
                <div class="md:w-48">
                    <select 
                        id="sortFilter"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-blue-600 transition"
                    >
                        <option value="newest">Newest First</option>
                        <option value="oldest">Oldest First</option>
                        <option value="name">Seller Name (A-Z)</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Reports List -->
        <div id="reportsContainer">
            <!-- Empty State (shown when no reports) -->
            <div id="emptyState" class="empty-state rounded-xl p-12 text-center">
                <div class="text-5xl mb-6">üìä</div>
                <h3 class="text-2xl font-bold text-gray-800 mb-4">No reports found</h3>
                <p class="text-gray-600 mb-8 max-w-md mx-auto">
                    Be the first to submit a scam report and help protect the community.
                </p>
                <a href="ReportScam.html" class="inline-block bg-red-600 text-white font-semibold px-8 py-3 rounded-lg hover:bg-red-700 transition">
                    Submit First Report
                </a>
            </div>

            <!-- Reports Grid (hidden by default) -->
            <div id="reportsGrid" class="hidden">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Report cards will be dynamically inserted here -->
                </div>
            </div>
        </div>

        <!-- Sample Reports (for demonstration, hidden initially) -->
        <div id="sampleReports" class="hidden">
            <!-- Report Card Template -->
            <div class="report-card bg-white rounded-xl shadow-md p-6">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-1">John Scammer</h3>
                        <p class="text-gray-600">+855 12 345 678</p>
                    </div>
                    <span class="platform-tag platform-facebook">Facebook</span>
                </div>
                
                <p class="text-gray-700 mb-4 line-clamp-3">
                    Seller promised to deliver iPhone 14 but never shipped. Asked for payment via Wing transfer and then blocked me. Lost $350.
                </p>
                
                <div class="flex justify-between items-center text-sm text-gray-500">
                    <span>Submitted: 2 days ago</span>
                    <button class="text-blue-600 font-medium hover:text-blue-800">
                        View Details ‚Üí
                    </button>
                </div>
            </div>

            <!-- More sample reports... -->
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-8 mt-12">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-6 md:mb-0 text-center md:text-left">
                    <div class="flex items-center justify-center md:justify-start space-x-3 mb-4">
                        <div class="bg-red-600 text-white p-2 rounded-lg">
                            <span class="text-xl">üõ°Ô∏è</span>
                        </div>
                        <div>
                            <h1 class="text-2xl font-bold">ScamShield</h1>
                            <p class="text-sm text-gray-400 -mt-1">Online Selling Scam Report Platform</p>
                        </div>
                    </div>
                    <p class="text-gray-400">Protecting Cambodian online shoppers from scams.</p>
                </div>
                
                <div class="text-center md:text-right">
                    <p class="text-gray-400 mb-2">¬© 2025 ScamShield - Online Selling Scam Report Platform</p>
                    <p class="text-gray-500 text-sm">
                        Developed by Sorayuth Roth & Strongchhay Ly | Cambodia Academy of Digital Technology (CADT)
                    </p>
                    <p class="text-gray-500 text-sm mt-1">
                        Data stored locally in your browser. No personal information is sent to external servers.
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Report Details Modal -->
    <div id="reportModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">Report Details</h2>
                <button id="closeModal" class="text-gray-500 hover:text-gray-700 text-2xl">
                    √ó
                </button>
            </div>
            
            <div id="modalContent">
                <!-- Modal content will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        // Mobile menu toggle
        document.getElementById('mobile-menu-button').addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobile-menu');
            if (mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.remove('hidden');
            } else {
                mobileMenu.classList.add('hidden');
            }
        });

        // Load and display reports from localStorage
        function loadReports() {
            const reports = JSON.parse(localStorage.getItem('scamReports') || '[]');
            const totalReports = document.getElementById('totalReports');
            const emptyState = document.getElementById('emptyState');
            const reportsGrid = document.getElementById('reportsGrid');
            const gridContainer = document.querySelector('#reportsGrid .grid');
            
            // Update total count
            totalReports.textContent = reports.length;
            
            if (reports.length === 0) {
                emptyState.classList.remove('hidden');
                reportsGrid.classList.add('hidden');
                return;
            }
            
            // Show reports grid
            emptyState.classList.add('hidden');
            reportsGrid.classList.remove('hidden');
            
            // Clear existing cards
            gridContainer.innerHTML = '';
            
            // Add report cards
            reports.forEach((report, index) => {
                const reportCard = createReportCard(report, index);
                gridContainer.appendChild(reportCard);
            });
        }
        
        // Create a report card element
        function createReportCard(report, index) {
            const card = document.createElement('div');
            card.className = 'report-card bg-white rounded-xl shadow-md p-6';
            
            // Format date
            const date = new Date(report.timestamp);
            const timeAgo = getTimeAgo(date);
            
            // Get platform class
            const platformClass = `platform-${report.platform || 'other'}`;
            const platformName = getPlatformName(report.platform);
            
            card.innerHTML = `
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-1">${report.sellerName || 'Unknown Seller'}</h3>
                        <p class="text-gray-600">${report.phoneNumber || 'No phone provided'}</p>
                    </div>
                    <span class="platform-tag ${platformClass}">${platformName}</span>
                </div>
                
                <p class="text-gray-700 mb-4 line-clamp-3">
                    ${report.incidentDescription || 'No description provided'}
                </p>
                
                <div class="flex justify-between items-center text-sm text-gray-500">
                    <span>Submitted: ${timeAgo}</span>
                    <button onclick="showReportDetails(${index})" class="text-blue-600 font-medium hover:text-blue-800">
                        View Details ‚Üí
                    </button>
                </div>
            `;
            
            return card;
        }
        
        // Get platform display name
        function getPlatformName(platform) {
            const platforms = {
                'facebook': 'Facebook',
                'telegram': 'Telegram',
                'whatsapp': 'WhatsApp',
                'instagram': 'Instagram',
                'tiktok': 'TikTok',
                'other': 'Other'
            };
            return platforms[platform] || 'Unknown';
        }
        
        // Calculate time ago
        function getTimeAgo(date) {
            const now = new Date();
            const diffMs = now - date;
            const diffMins = Math.floor(diffMs / (1000 * 60));
            const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
            
            if (diffMins < 60) {
                return `${diffMins} minute${diffMins !== 1 ? 's' : ''} ago`;
            } else if (diffHours < 24) {
                return `${diffHours} hour${diffHours !== 1 ? 's' : ''} ago`;
            } else if (diffDays < 7) {
                return `${diffDays} day${diffDays !== 1 ? 's' : ''} ago`;
            } else {
                return date.toLocaleDateString();
            }
        }
        
        // Show report details in modal
        function showReportDetails(index) {
            const reports = JSON.parse(localStorage.getItem('scamReports') || '[]');
            const report = reports[index];
            
            if (!report) return;
            
            const modal = document.getElementById('reportModal');
            const content = document.getElementById('modalContent');
            
            // Format date
            const date = new Date(report.timestamp);
            const formattedDate = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
            
            // Get platform name
            const platformName = getPlatformName(report.platform);
            
            content.innerHTML = `
                <div class="space-y-6">
                    <!-- Seller Info -->
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h3 class="font-bold text-gray-800 mb-2">Seller Information</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <p class="text-gray-600 text-sm">Seller Name:</p>
                                <p class="font-medium text-gray-800">${report.sellerName || 'Not provided'}</p>
                            </div>
                            <div>
                                <p class="text-gray-600 text-sm">Phone Number:</p>
                                <p class="font-medium text-gray-800">${report.phoneNumber || 'Not provided'}</p>
                            </div>
                            <div>
                                <p class="text-gray-600 text-sm">Platform:</p>
                                <p class="font-medium text-gray-800">${platformName}</p>
                            </div>
                            <div>
                                <p class="text-gray-600 text-sm">Profile URL:</p>
                                <p class="font-medium text-gray-800 truncate">${report.platformLink || 'Not provided'}</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Incident Description -->
                    <div>
                        <h3 class="font-bold text-gray-800 mb-2">Incident Description</h3>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <p class="text-gray-700 whitespace-pre-wrap">${report.incidentDescription || 'No description provided'}</p>
                        </div>
                    </div>
                    
                    <!-- Report Metadata -->
                    <div>
                        <h3 class="font-bold text-gray-800 mb-2">Report Information</h3>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <p class="text-gray-600">Submitted: ${formattedDate}</p>
                            <p class="text-gray-600 mt-1">Report ID: ${index + 1}</p>
                        </div>
                    </div>
                    
                    <!-- Screenshots -->
                    ${report.screenshots > 0 ? `
                        <div>
                            <h3 class="font-bold text-gray-800 mb-2">Screenshots</h3>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <p class="text-gray-600">${report.screenshots} screenshot(s) attached</p>
                                <p class="text-gray-500 text-sm mt-1">Screenshots are stored locally in your browser.</p>
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;
            
            modal.classList.remove('hidden');
        }
        
        // Close modal
        document.getElementById('closeModal').addEventListener('click', function() {
            document.getElementById('reportModal').classList.add('hidden');
        });
        
        // Close modal when clicking outside
        document.getElementById('reportModal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.add('hidden');
            }
        });
        
        // Search functionality
        document.getElementById('searchInput').addEventListener('input', function(e) {
            filterReports();
        });
        
        // Platform filter functionality
        document.getElementById('platformFilter').addEventListener('change', function(e) {
            filterReports();
        });
        
        // Sort functionality
        document.getElementById('sortFilter').addEventListener('change', function(e) {
            filterReports();
        });
        
        // Filter and sort reports
        function filterReports() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const platformFilter = document.getElementById('platformFilter').value;
            const sortBy = document.getElementById('sortFilter').value;
            
            let reports = JSON.parse(localStorage.getItem('scamReports') || '[]');
            
            // Apply search filter
            if (searchTerm) {
                reports = reports.filter(report => 
                    (report.sellerName && report.sellerName.toLowerCase().includes(searchTerm)) ||
                    (report.phoneNumber && report.phoneNumber.toLowerCase().includes(searchTerm)) ||
                    (report.incidentDescription && report.incidentDescription.toLowerCase().includes(searchTerm))
                );
            }
            
            // Apply platform filter
            if (platformFilter !== 'all') {
                reports = reports.filter(report => report.platform === platformFilter);
            }
            
            // Apply sorting
            reports.sort((a, b) => {
                const dateA = new Date(a.timestamp);
                const dateB = new Date(b.timestamp);
                
                switch(sortBy) {
                    case 'newest':
                        return dateB - dateA;
                    case 'oldest':
                        return dateA - dateB;
                    case 'name':
                        return (a.sellerName || '').localeCompare(b.sellerName || '');
                    default:
                        return dateB - dateA;
                }
            });
            
            // Update display
            updateReportsDisplay(reports);
        }
        
        // Update reports display with filtered/sorted results
        function updateReportsDisplay(reports) {
            const emptyState = document.getElementById('emptyState');
            const reportsGrid = document.getElementById('reportsGrid');
            const gridContainer = document.querySelector('#reportsGrid .grid');
            
            if (reports.length === 0) {
                emptyState.classList.remove('hidden');
                reportsGrid.classList.add('hidden');
                return;
            }
            
            // Show reports grid
            emptyState.classList.add('hidden');
            reportsGrid.classList.remove('hidden');
            
            // Clear existing cards
            gridContainer.innerHTML = '';
            
            // Add report cards
            reports.forEach((report, index) => {
                const reportCard = createReportCard(report, index);
                gridContainer.appendChild(reportCard);
            });
        }
        
        // Load reports when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadReports();
        });
    </script>
</body>
</html>